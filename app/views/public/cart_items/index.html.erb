<h6>ショッピングカート</h6>
<%= link_to "カートを空にする", all_destroy_cart_items_path, method: :delete,class: "btn btn-danger btn-sm" %>
<table>
  <tr>
    <th>商品名</th>
    <th>単価(税込)</th>
    <th>数量</th>
    <th>小計</th>
    <th></th>
  </tr>

    <% @cart_items.each do |cart_item| %>
      <tr>
      <td>
        <%= attachment_image_tag(cart_item.item, :image, size: "60x50", fallback: "no_image.jpg") %>
        <%= cart_item.item.name %>
      </td>
      <td>
        <%= cart_item.item.with_tax_price %>
      </td>
      <td>
        <%= form_with model: cart_item, url: cart_item_path(cart_item), local: true, method: :patch do |f| %>
          <%= f.number_field :quantity, min: 1, max:10, id: "quantity_cart"%>
          <%= f.submit "変更",class: "btn btn-success" %>
        <% end %>
      </td>
      <td>
        <%= cart_item.subtotal %>
        <p>test</p>
      </td>
      <td></td>
    </tr>
    <% @total_price += cart_item.subtotal %>
    <% end %>

    <tr>
      <th>合計金額</th>
      <td><%= @total_price %></td>
    </tr>
    
    

</table>


<% if @cart_items.present? %>
    <p>カートに商品がある</p>
<% end %>